(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/xiche/xinzheng_dingdan/xinzheng_dingdan"],{"21ad":function(i,n,e){"use strict";e.r(n);var a=e("3cca"),o=e("b589");for(var t in o)"default"!==t&&function(i){e.d(n,i,(function(){return o[i]}))}(t);e("e8e6");var c,l=e("f0c5"),u=Object(l["a"])(o["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],c);n["default"]=u.exports},"3cca":function(i,n,e){"use strict";var a;e.d(n,"b",(function(){return o})),e.d(n,"c",(function(){return t})),e.d(n,"a",(function(){return a}));var o=function(){var i=this,n=i.$createElement;i._self._c},t=[]},"7a3e":function(i,n,e){},"87e9":function(i,n,e){"use strict";(function(i){e("0db0");a(e("66fd"));var n=a(e("21ad"));function a(i){return i&&i.__esModule?i:{default:i}}wx.__webpack_require_UNI_MP_PLUGIN__=e,i(n.default)}).call(this,e("543d")["createPage"])},b589:function(i,n,e){"use strict";e.r(n);var a=e("f6e4"),o=e.n(a);for(var t in a)"default"!==t&&function(i){e.d(n,i,(function(){return a[i]}))}(t);n["default"]=o.a},e8e6:function(i,n,e){"use strict";var a=e("7a3e"),o=e.n(a);o.a},f6e4:function(i,n,e){"use strict";(function(i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e={components:{},data:function(){return{xiche_fangshi_dangqian:0,xiche_fangshi_liebiao:["外观洗","全车洗","精致洗"],jiage_xianzhi:0,xiche_jiage_dangqian:0,xiche_jiage_liebiao:["50元以内","100元以内"],getPrice:[],xiche_jinji_dangqian:0,xiche_jinji_liebiao:["否","是"],xiche_jinji_shuoming:"服务将在下单日晚8：00至次日早晨6：00完成。",cheliang_list:{carNum:"加载中...",loactionName:"加载中...",contactsPhone:"加载中...",carContacts:"加载中...",memo:""},cheliang_xuanzhe:-1,dingdan_num:0,beizhu:"",a:"",input:{loactionName:"",memo:"",carLongitude:"",carLatitude:""},b:"",modalName:"",getExplanation:"",carId:0,carNumisNull:!0}},onShow:function(){var n=this;if(n.xiche_jiage_huoqu(),0==n.carId)n.huoqu_chepai_liebiao();else{i.showLoading({title:"信息加载中"}),setTimeout((function(){i.hideLoading()}),500);var e={carId:n.carId};console.log(e),n.wangluo_qingqiu("/wx/carw/getCarInfo",e,!0,!0,"GET").then((function(i){if(i){n.cheliang_list=i,console.log("车牌id",i.carId),console.log(n.cheliang_list);var e={carNum:i.carNum};n.wangluo_qingqiu("/wx/carw/checkCarNumIsOrdering",e,!0,!0,"GET").then((function(i){console.log(e,i),1==i?(n.carNumisNull=!1,console.log(i)):n.carNumisNull=!0}))}}))}n.wangluo_qingqiu("/wx/carw/getOrdering",null,!0,!0,"GET").then((function(i){i&&(n.dingdan_num=i.length,console.log("服务中的订单数量"),console.log(i.length))})),getApp().globalData.xiche_jiamubiao[0]=getApp().globalData.public_server_url+"/profile/upload/price/priceList.jpg?v="+Math.random()},methods:{selectCard:function(){i.navigateTo({url:"../selectCar/selectCar?carId="+this.cheliang_list.carId})},hideModal:function(){this.modalName=""},showTheModal:function(){var n=this;if(n.dingdan_num>=2)return i.showModal({title:"提示",content:"您已有两个或以上的订单正在进行中，请结束后再试",showCancel:!1,success:function(){}}),!1;this.modalName="ChooseModal"},priceImg:function(){var n=getApp().globalData.xiche_jiamubiao,e=0;console.log("打开图片",n),i.previewImage({urls:n,current:e})},xiche_jiage_huoqu:function(){var i=this;i.wangluo_qingqiu("/wx/carw/getPrice",null,!0,!0,"GET").then((function(n){console.log("/wx/carw/getPrice"),console.log(n),n&&(i.xiche_jiage_liebiao=n.map((function(i){return i.dictLabel})),i.getPrice=n,console.log(i.xiche_jiage_liebiao))})),i.wangluo_qingqiu("/wx/carw/getExplanation",null,!0,!0,"GET").then((function(n){console.log("/wx/carw/getExplanation"),console.log(n),n&&(i.getExplanation=n)}))},huoqu_weizhi_xinxi:function(){var n=this;i.getSetting({success:function(e){e.authSetting["scope.userLocation"]?i.chooseLocation({success:function(i){n.input.loactionName=i.name,n.input.memo=i.address,n.input.carLongitude=i.longitude,n.input.carLatitude=i.latitude}}):i.authorize({scope:"scope.userLocation",success:function(){i.chooseLocation({success:function(i){n.input.loactionName=i.name,n.input.memo=i.address,n.input.carLongitude=i.longitude,n.input.carLatitude=i.latitude,console.log(n.input.memo)}})}})}})},xiche_jiage_xuanzhe:function(i){this.xiche_jiage_dangqian=i.detail.value},xiche_jinji_xuanzhe:function(n){this.a=n.detail.value,0==this.a?(this.xiche_jinji_dangqian=this.a,this.xiche_jinji_shuoming="服务将在下单日晚8：00至次日早晨6：00完成。"):(this.xiche_jinji_dangqian=this.a,this.xiche_jinji_shuoming="紧急服务将多收取20元调度费用。"),2==this.xiche_fangshi_dangqian&&1==this.a&&(this.xiche_jinji_dangqian=0,this.xiche_jinji_shuoming="服务将在下单日晚8：00至次日早晨6：00完成。",i.showModal({title:"提示",content:"非常抱歉，由于精致洗耗时较久，需要预约，无法执行紧急服务。",showCancel:!1,success:function(i){}}))},huoqu_chepai_liebiao:function(){var i=this;i.wangluo_qingqiu("/wx/carw/getCar",null,!0,!0,"GET").then((function(n){if(n){i.cheliang_list=n[0],i.carId=n[0].carId,console.log("车辆列表",i.carId),console.log(n);var e={carNum:i.cheliang_list.carNum};i.wangluo_qingqiu("/wx/carw/checkCarNumIsOrdering",e,!0,!0,"GET").then((function(n){console.log(e,n),i.carNumisNull=1!=n}))}}))},clickFreeOrder:function(){var n=this;i.showModal({titile:"提示",content:"管家将于今晚18:30后开始接单，管家接单后会立即与您电话联系，请保持您的手机畅通，非常感谢您的支持",success:function(e){var a=e.confirm,o=e.cancel;o?i.navigateBack({}):a&&n.tijiao_xiche_dingdan()}})},tijiao_xiche_dingdan:function(){var n=this;if(!n.carNumisNull)return i.showModal({title:"提示",content:"该车牌已有订单正在进行中",showCancel:!1,success:function(){}}),!1;if(n.dingdan_num>2)i.showModal({title:"提示",content:"您已有三个或以上的订单正在进行中，请结束后再试",showCancel:!1,success:function(){}});else{for(var e=n.cheliang_list,a=0;a<e.length;a++)console.log(n.cheliang_list[a]),n.cheliang_xuanzhe==n.cheliang_list[a].carId&&(n.b=n.cheliang_list[a].memo);i.requestSubscribeMessage({tmplIds:["qBM01AyCHsAIMnJyK7lORvzrQ-6uTCY_6CnqMEfAf34","qksBgtDb2oKaovE7TcFVETRkQR8L3Qpwu7Xa4uhHo5I","3BLN5rDr4xxDYlQnjpoGqeqiO-SJLN_v4v4P6V1kSSo"],success:function(e){var a={carId:n.cheliang_list.carId,priceLimit:n.getPrice[n.xiche_jiage_dangqian].dictValue,userMemo:n.beizhu,memo:n.cheliang_list.memo};console.log("data",a),n.wangluo_qingqiu("/wx/carw/setOrder",a,!0,!0,"POST").then((function(n){n&&(console.log("setOrder"),console.log(n),i.hideLoading(),i.showModal({title:"提示",content:"提交完成。",showCancel:!1,success:function(){i.switchTab({url:"../index/index"})}}))}))}.bind(this),fail:function(n){console.log("err"),console.log(n),i.showModal({title:"注意",content:"请在设置中打开通知推送",confirmText:"知道了",showCancel:!1,success:function(i){}})}})}}},onShareAppMessage:function(i){return{title:"晨夜车管家",path:"/pages/xiche/index/index",imageUrl:"/static/img/logo.png"}}};n.default=e}).call(this,e("543d")["default"])}},[["87e9","common/runtime","common/vendor"]]]);