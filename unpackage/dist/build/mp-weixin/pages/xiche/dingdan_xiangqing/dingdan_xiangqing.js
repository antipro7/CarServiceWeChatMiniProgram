(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/xiche/dingdan_xiangqing/dingdan_xiangqing"],{"124c":function(e,r,t){"use strict";t.r(r);var n=t("a945"),i=t.n(n);for(var o in n)"default"!==o&&function(e){t.d(r,e,(function(){return n[e]}))}(o);r["default"]=i.a},"1d24":function(e,r,t){"use strict";var n;t.d(r,"b",(function(){return i})),t.d(r,"c",(function(){return o})),t.d(r,"a",(function(){return n}));var i=function(){var e=this,r=e.$createElement,t=(e._self._c,e.__map(e.getOrderById.carwService.projects,(function(r,t){var n=e.__get_orig(r),i=null!=e.getOrderById.carwService?Math.abs(r.price):null;return{$orig:n,g0:i}}))),n="订单已结束"==e.getOrderById.stateName&&1==e.getOrderById.payState&&null!=e.getOrderById.carwService&&0!=e.reduce?Math.abs(e.reduce):null,i=null!=e.getOrderById.carwService?(Number(e.finishpay)+Number(e.reduce)).toFixed(2):null;e.$mp.data=Object.assign({},{$root:{l0:t,g1:n,g2:i}})},o=[]},9686:function(e,r,t){"use strict";t.r(r);var n=t("1d24"),i=t("124c");for(var o in i)"default"!==o&&function(e){t.d(r,e,(function(){return i[e]}))}(o);t("f703");var a,c=t("f0c5"),u=Object(c["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],a);r["default"]=u.exports},a5e5:function(e,r,t){},a945:function(e,r,t){"use strict";(function(e){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var t={components:{},data:function(){return{orderId:0,orderDetail:[],public_server_img:"",jiagexianzhi:"",yincang_chekuang:!0,yincang_fuwu:!0,yincang_anniu:!0,a:[],conditionExplain:[],priceDetails:[],resultMsg:[],getOrderById:[],imgLists:[],imgListsFuwu:[],totalpay:0,reduce:0,reduceHuiyuan:0,userpay:0,finishpay:0}},onLoad:function(e){this.public_server_img=getApp().globalData.public_server_url,console.log("orderId"),console.log(e.orderId),this.orderId=e.orderId},methods:{userPayBtn:function(){console.log(this.totalpay,this.reduceHuiyuan,this.reduce);var r=1;null!=this.getOrderById.carwService&&(r=2);var t=Number(this.totalpay)-Number(this.reduceHuiyuan)+Number(this.reduce),n={price:t.toFixed(2),payState:r,orderUid:this.getOrderById.orderUid,discountedPrice:this.reduceHuiyuan};console.log("data2",n);var i=this;0==n.price?e.showModal({title:"提示",content:"是否进行付款？",success:function(r){r.confirm?(console.log("用户点击确定"),i.wangluo_qingqiu("/wx/pay/payZero",n,!0,!0,"POST").then((function(r){console.log(r),r&&e.showModal({title:"提示",content:"支付成功。",confirmText:"知道了",showCancel:!1,success:function(e){i.getOrderByIdDetail()}})}))):r.cancel&&console.log("用户点击取消")}.bind(this)}):i.wangluo_qingqiu("/wx/pay/sendipmsfeecharge",n,!0,!0,"POST").then((function(r){r&&(console.log("sendipmsfeecharge"),console.log(r),e.requestPayment({provider:"wxpay",timeStamp:r.timeStamp,nonceStr:r.nonceStr,package:r.package,signType:r.signType,paySign:r.paySign,success:function(e){console.log(e),i.getOrderByIdDetail()},fail:function(r){console.log("err"),console.log(r),e.showModal({title:"注意",content:"取消支付。",confirmText:"知道了",showCancel:!1,success:function(e){}})}}))}))},boda_dianhua:function(r){e.makePhoneCall({phoneNumber:r})},ViewImage:function(r){e.previewImage({urls:this.imgLists,current:r.currentTarget.dataset.url})},ViewImage2:function(r){e.previewImage({urls:this.imgListsFuwu,current:r.currentTarget.dataset.url})},chakandatu:function(r){console.log(r);var t=r,n=0;e.previewImage({urls:t,current:n})},chakandatu2:function(r){console.log(r[0].length);for(var t=0;t<r[0].length;t++){var n;n=0==r[2]?getApp().globalData.public_server_url+r[0][t].fileUrls[0].fileUrl:getApp().globalData.public_server_url+r[0][t].fileUrl,this.a[t]=n,console.log(this.a)}var i=this.a,o=r[1];e.previewImage({urls:i,current:o})},complete:function(){var r=this;console.log(getApp().globalData.public_yonghu_yue),console.log(r.orderDetail.carwService.totalPrice),e.showModal({title:"提示",content:"确认付款？",success:function(t){if(t.confirm){console.log("用户点击确定");var n={orderId:r.orderId};console.log(n),r.wangluo_qingqiu("/wx/carw/settlementOrder",n,!0,!0,"POST").then((function(r){r&&e.navigateBack({})}))}else t.cancel&&console.log("用户点击取消")}.bind(this)})},getOrderByIdDetail:function(){var e=this,r={orderId:e.orderId};console.log(r),e.resultMsg=[],e.conditionExplain=[],e.priceDetails=[],e.wangluo_qingqiu("/wx/carw/getOrderById",r,!0,!0,"GET").then((function(r){if(r){console.log(r),e.getOrderById=r,e.orderDetail=r;var t=0;if(null!=r.carwCondition){e.imgLists=[];for(var n=0;n<r.carwCondition.files.length;n++)e.imgLists.push(e.public_server_img+r.carwCondition.files[n].fileUrl);for(var i=0,o=0;o<r.carwCondition.services.length;o++)i=Number(i)+Number(r.carwCondition.services[o].servicePrice);e.totalpay=i,null!=r.discountedPrice?t=Number(e.totalpay)-Number(r.discountedPrice):"晨夜会员"==r.cardName?(e.reduceHuiyuan=(.12*i).toFixed(2),t=Number(e.totalpay)-Number(e.reduceHuiyuan)):t=Number(e.totalpay),t=t.toFixed(2),e.userpay=t,e.finishpay=t}if(null!=r.carwService){e.imgListsFuwu=[];for(var a=0;a<r.carwService.files.length;a++)e.imgListsFuwu.push(e.public_server_img+r.carwService.files[a].fileUrl);for(var c=0,u=0;u<r.carwService.projects.length;u++)c=Number(c)+Number(r.carwService.projects[u].price);e.reduce=c.toFixed(2),2==r.payState&&(t=Number(t)+Number(c),t=t.toFixed(2),e.userpay=t)}else e.getOrderById.carwService["projects"]=[];console.log(e.userpay,e.reduce,r.discountedPrice)}}))}},onShareAppMessage:function(e){return{title:"晨夜车管家",path:"/pages/xiche/index/index",imageUrl:"/static/img/logo.png"}},onShow:function(){var e=this;e.getOrderByIdDetail()}};r.default=t}).call(this,t("543d")["default"])},ed4c:function(e,r,t){"use strict";(function(e){t("0db0");n(t("66fd"));var r=n(t("9686"));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=t,e(r.default)}).call(this,t("543d")["createPage"])},f703:function(e,r,t){"use strict";var n=t("a5e5"),i=t.n(n);i.a}},[["ed4c","common/runtime","common/vendor"]]]);